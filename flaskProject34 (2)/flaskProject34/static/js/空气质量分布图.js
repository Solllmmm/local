const fetch_city_year=(city,year)=>{
fetch(`/aqi_fenbu?city=${city}&year=${year}`)
    .then(response=>response.json())
    .then(data=>{
        const dataOrigin = {
            xAxisData: [
                '01',
                '02',
                '03',
                '04',
                '05',
                '06',
                '07',
                '08',
                '09',
                '10',
                '11',
                '12',
                '13',
                '14',
                '15',
                '16',
                '17',
                '18',
                '19',
                '20',
                '21',
                '22',
                '23',
                '24',
                '25',
                '26',
                '27',
                '28',
                '29',
                '30',
                '31',
            ],
            yAxisData: [
                data[0]['year']+'-01',
                data[0]['year']+'-02',
                data[0]['year']+'-03',
                data[0]['year']+'-04',
                data[0]['year']+'-05',
               data[0]['year']+'-06',
                data[0]['year']+'-07',
                data[0]['year']+'-08',
              data[0]['year']+'-09',
                data[0]['year']+'-10',
               data[0]['year']+'-11',
                data[0]['year']+'-12',
            ],
            seriesDatas: [
                {

                    data: [

[data[0]['day'], data[0]['month'], data[0]['aqi']],
[data[1]['day'], data[1]['month'], data[1]['aqi']],
[data[2]['day'], data[2]['month'], data[2]['aqi']],
[data[3]['day'], data[3]['month'], data[3]['aqi']],
[data[4]['day'], data[4]['month'], data[4]['aqi']],
[data[5]['day'], data[5]['month'], data[5]['aqi']],
[data[6]['day'], data[6]['month'], data[6]['aqi']],
[data[7]['day'], data[7]['month'], data[7]['aqi']],
[data[8]['day'], data[8]['month'], data[8]['aqi']],
[data[9]['day'], data[9]['month'], data[9]['aqi']],
[data[10]['day'], data[10]['month'], data[10]['aqi']],
[data[11]['day'], data[11]['month'], data[11]['aqi']],
[data[12]['day'], data[12]['month'], data[12]['aqi']],
[data[13]['day'], data[13]['month'], data[13]['aqi']],
[data[14]['day'], data[14]['month'], data[14]['aqi']],
[data[15]['day'], data[15]['month'], data[15]['aqi']],
[data[16]['day'], data[16]['month'], data[16]['aqi']],
[data[17]['day'], data[17]['month'], data[17]['aqi']],
[data[18]['day'], data[18]['month'], data[18]['aqi']],
[data[19]['day'], data[19]['month'], data[19]['aqi']],
[data[20]['day'], data[20]['month'], data[20]['aqi']],
[data[21]['day'], data[21]['month'], data[21]['aqi']],
[data[22]['day'], data[22]['month'], data[22]['aqi']],
[data[23]['day'], data[23]['month'], data[23]['aqi']],
[data[24]['day'], data[24]['month'], data[24]['aqi']],
[data[25]['day'], data[25]['month'], data[25]['aqi']],
[data[26]['day'], data[26]['month'], data[26]['aqi']],
[data[27]['day'], data[27]['month'], data[27]['aqi']],
[data[28]['day'], data[28]['month'], data[28]['aqi']],
[data[29]['day'], data[29]['month'], data[29]['aqi']],
[data[30]['day'], data[30]['month'], data[30]['aqi']],
[data[31]['day'], data[31]['month'], data[31]['aqi']],
[data[32]['day'], data[32]['month'], data[32]['aqi']],
[data[33]['day'], data[33]['month'], data[33]['aqi']],
[data[34]['day'], data[34]['month'], data[34]['aqi']],
[data[35]['day'], data[35]['month'], data[35]['aqi']],
[data[36]['day'], data[36]['month'], data[36]['aqi']],
[data[37]['day'], data[37]['month'], data[37]['aqi']],
[data[38]['day'], data[38]['month'], data[38]['aqi']],
[data[39]['day'], data[39]['month'], data[39]['aqi']],
[data[40]['day'], data[40]['month'], data[40]['aqi']],
[data[41]['day'], data[41]['month'], data[41]['aqi']],
[data[42]['day'], data[42]['month'], data[42]['aqi']],
[data[43]['day'], data[43]['month'], data[43]['aqi']],
[data[44]['day'], data[44]['month'], data[44]['aqi']],
[data[45]['day'], data[45]['month'], data[45]['aqi']],
[data[46]['day'], data[46]['month'], data[46]['aqi']],
[data[47]['day'], data[47]['month'], data[47]['aqi']],
[data[48]['day'], data[48]['month'], data[48]['aqi']],
[data[49]['day'], data[49]['month'], data[49]['aqi']],
[data[50]['day'], data[50]['month'], data[50]['aqi']],
[data[51]['day'], data[51]['month'], data[51]['aqi']],
[data[52]['day'], data[52]['month'], data[52]['aqi']],
[data[53]['day'], data[53]['month'], data[53]['aqi']],
[data[54]['day'], data[54]['month'], data[54]['aqi']],
[data[55]['day'], data[55]['month'], data[55]['aqi']],
[data[56]['day'], data[56]['month'], data[56]['aqi']],
[data[57]['day'], data[57]['month'], data[57]['aqi']],
[data[58]['day'], data[58]['month'], data[58]['aqi']],
[data[59]['day'], data[59]['month'], data[59]['aqi']],
[data[60]['day'], data[60]['month'], data[60]['aqi']],
[data[61]['day'], data[61]['month'], data[61]['aqi']],
[data[62]['day'], data[62]['month'], data[62]['aqi']],
[data[63]['day'], data[63]['month'], data[63]['aqi']],
[data[64]['day'], data[64]['month'], data[64]['aqi']],
[data[65]['day'], data[65]['month'], data[65]['aqi']],
[data[66]['day'], data[66]['month'], data[66]['aqi']],
[data[67]['day'], data[67]['month'], data[67]['aqi']],
[data[68]['day'], data[68]['month'], data[68]['aqi']],
[data[69]['day'], data[69]['month'], data[69]['aqi']],
[data[70]['day'], data[70]['month'], data[70]['aqi']],
[data[71]['day'], data[71]['month'], data[71]['aqi']],
[data[72]['day'], data[72]['month'], data[72]['aqi']],
[data[73]['day'], data[73]['month'], data[73]['aqi']],
[data[74]['day'], data[74]['month'], data[74]['aqi']],
[data[75]['day'], data[75]['month'], data[75]['aqi']],
[data[76]['day'], data[76]['month'], data[76]['aqi']],
[data[77]['day'], data[77]['month'], data[77]['aqi']],
[data[78]['day'], data[78]['month'], data[78]['aqi']],
[data[79]['day'], data[79]['month'], data[79]['aqi']],
[data[80]['day'], data[80]['month'], data[80]['aqi']],
[data[81]['day'], data[81]['month'], data[81]['aqi']],
[data[82]['day'], data[82]['month'], data[82]['aqi']],
[data[83]['day'], data[83]['month'], data[83]['aqi']],
[data[84]['day'], data[84]['month'], data[84]['aqi']],
[data[85]['day'], data[85]['month'], data[85]['aqi']],
[data[86]['day'], data[86]['month'], data[86]['aqi']],
[data[87]['day'], data[87]['month'], data[87]['aqi']],
[data[88]['day'], data[88]['month'], data[88]['aqi']],
[data[89]['day'], data[89]['month'], data[89]['aqi']],
[data[90]['day'], data[90]['month'], data[90]['aqi']],
[data[91]['day'], data[91]['month'], data[91]['aqi']],
[data[92]['day'], data[92]['month'], data[92]['aqi']],
[data[93]['day'], data[93]['month'], data[93]['aqi']],
[data[94]['day'], data[94]['month'], data[94]['aqi']],
[data[95]['day'], data[95]['month'], data[95]['aqi']],
[data[96]['day'], data[96]['month'], data[96]['aqi']],
[data[97]['day'], data[97]['month'], data[97]['aqi']],
[data[98]['day'], data[98]['month'], data[98]['aqi']],
[data[99]['day'], data[99]['month'], data[99]['aqi']],
[data[100]['day'], data[100]['month'], data[100]['aqi']],
[data[101]['day'], data[101]['month'], data[101]['aqi']],
[data[102]['day'], data[102]['month'], data[102]['aqi']],
[data[103]['day'], data[103]['month'], data[103]['aqi']],
[data[104]['day'], data[104]['month'], data[104]['aqi']],
[data[105]['day'], data[105]['month'], data[105]['aqi']],
[data[106]['day'], data[106]['month'], data[106]['aqi']],
[data[107]['day'], data[107]['month'], data[107]['aqi']],
[data[108]['day'], data[108]['month'], data[108]['aqi']],
[data[109]['day'], data[109]['month'], data[109]['aqi']],
[data[110]['day'], data[110]['month'], data[110]['aqi']],
[data[111]['day'], data[111]['month'], data[111]['aqi']],
[data[112]['day'], data[112]['month'], data[112]['aqi']],
[data[113]['day'], data[113]['month'], data[113]['aqi']],
[data[114]['day'], data[114]['month'], data[114]['aqi']],
[data[115]['day'], data[115]['month'], data[115]['aqi']],
[data[116]['day'], data[116]['month'], data[116]['aqi']],
[data[117]['day'], data[117]['month'], data[117]['aqi']],
[data[118]['day'], data[118]['month'], data[118]['aqi']],
[data[119]['day'], data[119]['month'], data[119]['aqi']],
[data[120]['day'], data[120]['month'], data[120]['aqi']],
[data[121]['day'], data[121]['month'], data[121]['aqi']],
[data[122]['day'], data[122]['month'], data[122]['aqi']],
[data[123]['day'], data[123]['month'], data[123]['aqi']],
[data[124]['day'], data[124]['month'], data[124]['aqi']],
[data[125]['day'], data[125]['month'], data[125]['aqi']],
[data[126]['day'], data[126]['month'], data[126]['aqi']],
[data[127]['day'], data[127]['month'], data[127]['aqi']],
[data[128]['day'], data[128]['month'], data[128]['aqi']],
[data[129]['day'], data[129]['month'], data[129]['aqi']],
[data[130]['day'], data[130]['month'], data[130]['aqi']],
[data[131]['day'], data[131]['month'], data[131]['aqi']],
[data[132]['day'], data[132]['month'], data[132]['aqi']],
[data[133]['day'], data[133]['month'], data[133]['aqi']],
[data[134]['day'], data[134]['month'], data[134]['aqi']],
[data[135]['day'], data[135]['month'], data[135]['aqi']],
[data[136]['day'], data[136]['month'], data[136]['aqi']],
[data[137]['day'], data[137]['month'], data[137]['aqi']],
[data[138]['day'], data[138]['month'], data[138]['aqi']],
[data[139]['day'], data[139]['month'], data[139]['aqi']],
[data[140]['day'], data[140]['month'], data[140]['aqi']],
[data[141]['day'], data[141]['month'], data[141]['aqi']],
[data[142]['day'], data[142]['month'], data[142]['aqi']],
[data[143]['day'], data[143]['month'], data[143]['aqi']],
[data[144]['day'], data[144]['month'], data[144]['aqi']],
[data[145]['day'], data[145]['month'], data[145]['aqi']],
[data[146]['day'], data[146]['month'], data[146]['aqi']],
[data[147]['day'], data[147]['month'], data[147]['aqi']],
[data[148]['day'], data[148]['month'], data[148]['aqi']],
[data[149]['day'], data[149]['month'], data[149]['aqi']],
[data[150]['day'], data[150]['month'], data[150]['aqi']],
[data[151]['day'], data[151]['month'], data[151]['aqi']],
[data[152]['day'], data[152]['month'], data[152]['aqi']],
[data[153]['day'], data[153]['month'], data[153]['aqi']],
[data[154]['day'], data[154]['month'], data[154]['aqi']],
[data[155]['day'], data[155]['month'], data[155]['aqi']],
[data[156]['day'], data[156]['month'], data[156]['aqi']],
[data[157]['day'], data[157]['month'], data[157]['aqi']],
[data[158]['day'], data[158]['month'], data[158]['aqi']],
[data[159]['day'], data[159]['month'], data[159]['aqi']],
[data[160]['day'], data[160]['month'], data[160]['aqi']],
[data[161]['day'], data[161]['month'], data[161]['aqi']],
[data[162]['day'], data[162]['month'], data[162]['aqi']],
[data[163]['day'], data[163]['month'], data[163]['aqi']],
[data[164]['day'], data[164]['month'], data[164]['aqi']],
[data[165]['day'], data[165]['month'], data[165]['aqi']],
[data[166]['day'], data[166]['month'], data[166]['aqi']],
[data[167]['day'], data[167]['month'], data[167]['aqi']],
[data[168]['day'], data[168]['month'], data[168]['aqi']],
[data[169]['day'], data[169]['month'], data[169]['aqi']],
[data[170]['day'], data[170]['month'], data[170]['aqi']],
[data[171]['day'], data[171]['month'], data[171]['aqi']],
[data[172]['day'], data[172]['month'], data[172]['aqi']],
[data[173]['day'], data[173]['month'], data[173]['aqi']],
[data[174]['day'], data[174]['month'], data[174]['aqi']],
[data[175]['day'], data[175]['month'], data[175]['aqi']],
[data[176]['day'], data[176]['month'], data[176]['aqi']],
[data[177]['day'], data[177]['month'], data[177]['aqi']],
[data[178]['day'], data[178]['month'], data[178]['aqi']],
[data[179]['day'], data[179]['month'], data[179]['aqi']],
[data[180]['day'], data[180]['month'], data[180]['aqi']],
[data[181]['day'], data[181]['month'], data[181]['aqi']],
[data[182]['day'], data[182]['month'], data[182]['aqi']],
[data[183]['day'], data[183]['month'], data[183]['aqi']],
[data[184]['day'], data[184]['month'], data[184]['aqi']],
[data[185]['day'], data[185]['month'], data[185]['aqi']],
[data[186]['day'], data[186]['month'], data[186]['aqi']],
[data[187]['day'], data[187]['month'], data[187]['aqi']],
[data[188]['day'], data[188]['month'], data[188]['aqi']],
[data[189]['day'], data[189]['month'], data[189]['aqi']],
[data[190]['day'], data[190]['month'], data[190]['aqi']],
[data[191]['day'], data[191]['month'], data[191]['aqi']],
[data[192]['day'], data[192]['month'], data[192]['aqi']],
[data[193]['day'], data[193]['month'], data[193]['aqi']],
[data[194]['day'], data[194]['month'], data[194]['aqi']],
[data[195]['day'], data[195]['month'], data[195]['aqi']],
[data[196]['day'], data[196]['month'], data[196]['aqi']],
[data[197]['day'], data[197]['month'], data[197]['aqi']],
[data[198]['day'], data[198]['month'], data[198]['aqi']],
[data[199]['day'], data[199]['month'], data[199]['aqi']],
[data[200]['day'], data[200]['month'], data[200]['aqi']],
[data[201]['day'], data[201]['month'], data[201]['aqi']],
[data[202]['day'], data[202]['month'], data[202]['aqi']],
[data[203]['day'], data[203]['month'], data[203]['aqi']],
[data[204]['day'], data[204]['month'], data[204]['aqi']],
[data[205]['day'], data[205]['month'], data[205]['aqi']],
[data[206]['day'], data[206]['month'], data[206]['aqi']],
[data[207]['day'], data[207]['month'], data[207]['aqi']],
[data[208]['day'], data[208]['month'], data[208]['aqi']],
[data[209]['day'], data[209]['month'], data[209]['aqi']],
[data[210]['day'], data[210]['month'], data[210]['aqi']],
[data[211]['day'], data[211]['month'], data[211]['aqi']],
[data[212]['day'], data[212]['month'], data[212]['aqi']],
[data[213]['day'], data[213]['month'], data[213]['aqi']],
[data[214]['day'], data[214]['month'], data[214]['aqi']],
[data[215]['day'], data[215]['month'], data[215]['aqi']],
[data[216]['day'], data[216]['month'], data[216]['aqi']],
[data[217]['day'], data[217]['month'], data[217]['aqi']],
[data[218]['day'], data[218]['month'], data[218]['aqi']],
[data[219]['day'], data[219]['month'], data[219]['aqi']],
[data[220]['day'], data[220]['month'], data[220]['aqi']],
[data[221]['day'], data[221]['month'], data[221]['aqi']],
[data[222]['day'], data[222]['month'], data[222]['aqi']],
[data[223]['day'], data[223]['month'], data[223]['aqi']],
[data[224]['day'], data[224]['month'], data[224]['aqi']],
[data[225]['day'], data[225]['month'], data[225]['aqi']],
[data[226]['day'], data[226]['month'], data[226]['aqi']],
[data[227]['day'], data[227]['month'], data[227]['aqi']],
[data[228]['day'], data[228]['month'], data[228]['aqi']],
[data[229]['day'], data[229]['month'], data[229]['aqi']],
[data[230]['day'], data[230]['month'], data[230]['aqi']],
[data[231]['day'], data[231]['month'], data[231]['aqi']],
[data[232]['day'], data[232]['month'], data[232]['aqi']],
[data[233]['day'], data[233]['month'], data[233]['aqi']],
[data[234]['day'], data[234]['month'], data[234]['aqi']],
[data[235]['day'], data[235]['month'], data[235]['aqi']],
[data[236]['day'], data[236]['month'], data[236]['aqi']],
[data[237]['day'], data[237]['month'], data[237]['aqi']],
[data[238]['day'], data[238]['month'], data[238]['aqi']],
[data[239]['day'], data[239]['month'], data[239]['aqi']],
[data[240]['day'], data[240]['month'], data[240]['aqi']],
[data[241]['day'], data[241]['month'], data[241]['aqi']],
[data[242]['day'], data[242]['month'], data[242]['aqi']],
[data[243]['day'], data[243]['month'], data[243]['aqi']],
[data[244]['day'], data[244]['month'], data[244]['aqi']],
[data[245]['day'], data[245]['month'], data[245]['aqi']],
[data[246]['day'], data[246]['month'], data[246]['aqi']],
[data[247]['day'], data[247]['month'], data[247]['aqi']],
[data[248]['day'], data[248]['month'], data[248]['aqi']],
[data[249]['day'], data[249]['month'], data[249]['aqi']],
[data[250]['day'], data[250]['month'], data[250]['aqi']],
[data[251]['day'], data[251]['month'], data[251]['aqi']],
[data[252]['day'], data[252]['month'], data[252]['aqi']],
[data[253]['day'], data[253]['month'], data[253]['aqi']],
[data[254]['day'], data[254]['month'], data[254]['aqi']],
[data[255]['day'], data[255]['month'], data[255]['aqi']],
[data[256]['day'], data[256]['month'], data[256]['aqi']],
[data[257]['day'], data[257]['month'], data[257]['aqi']],
[data[258]['day'], data[258]['month'], data[258]['aqi']],
[data[259]['day'], data[259]['month'], data[259]['aqi']],
[data[260]['day'], data[260]['month'], data[260]['aqi']],
[data[261]['day'], data[261]['month'], data[261]['aqi']],
[data[262]['day'], data[262]['month'], data[262]['aqi']],
[data[263]['day'], data[263]['month'], data[263]['aqi']],
[data[264]['day'], data[264]['month'], data[264]['aqi']],
[data[265]['day'], data[265]['month'], data[265]['aqi']],
[data[266]['day'], data[266]['month'], data[266]['aqi']],
[data[267]['day'], data[267]['month'], data[267]['aqi']],
[data[268]['day'], data[268]['month'], data[268]['aqi']],
[data[269]['day'], data[269]['month'], data[269]['aqi']],
[data[270]['day'], data[270]['month'], data[270]['aqi']],
[data[271]['day'], data[271]['month'], data[271]['aqi']],
[data[272]['day'], data[272]['month'], data[272]['aqi']],
[data[273]['day'], data[273]['month'], data[273]['aqi']],
[data[274]['day'], data[274]['month'], data[274]['aqi']],
[data[275]['day'], data[275]['month'], data[275]['aqi']],
[data[276]['day'], data[276]['month'], data[276]['aqi']],
[data[277]['day'], data[277]['month'], data[277]['aqi']],
[data[278]['day'], data[278]['month'], data[278]['aqi']],
[data[279]['day'], data[279]['month'], data[279]['aqi']],
[data[280]['day'], data[280]['month'], data[280]['aqi']],
[data[281]['day'], data[281]['month'], data[281]['aqi']],
[data[282]['day'], data[282]['month'], data[282]['aqi']],
[data[283]['day'], data[283]['month'], data[283]['aqi']],
[data[284]['day'], data[284]['month'], data[284]['aqi']],
[data[285]['day'], data[285]['month'], data[285]['aqi']],
[data[286]['day'], data[286]['month'], data[286]['aqi']],
[data[287]['day'], data[287]['month'], data[287]['aqi']],
[data[288]['day'], data[288]['month'], data[288]['aqi']],
[data[289]['day'], data[289]['month'], data[289]['aqi']],
[data[290]['day'], data[290]['month'], data[290]['aqi']],
[data[291]['day'], data[291]['month'], data[291]['aqi']],
[data[292]['day'], data[292]['month'], data[292]['aqi']],
[data[293]['day'], data[293]['month'], data[293]['aqi']],
[data[294]['day'], data[294]['month'], data[294]['aqi']],
[data[295]['day'], data[295]['month'], data[295]['aqi']],
[data[296]['day'], data[296]['month'], data[296]['aqi']],
[data[297]['day'], data[297]['month'], data[297]['aqi']],
[data[298]['day'], data[298]['month'], data[298]['aqi']],
[data[299]['day'], data[299]['month'], data[299]['aqi']],
[data[300]['day'], data[300]['month'], data[300]['aqi']],
[data[301]['day'], data[301]['month'], data[301]['aqi']],
[data[302]['day'], data[302]['month'], data[302]['aqi']],
[data[303]['day'], data[303]['month'], data[303]['aqi']],
[data[304]['day'], data[304]['month'], data[304]['aqi']],
[data[305]['day'], data[305]['month'], data[305]['aqi']],
[data[306]['day'], data[306]['month'], data[306]['aqi']],
[data[307]['day'], data[307]['month'], data[307]['aqi']],
[data[308]['day'], data[308]['month'], data[308]['aqi']],
[data[309]['day'], data[309]['month'], data[309]['aqi']],
[data[310]['day'], data[310]['month'], data[310]['aqi']],
[data[311]['day'], data[311]['month'], data[311]['aqi']],
[data[312]['day'], data[312]['month'], data[312]['aqi']],
[data[313]['day'], data[313]['month'], data[313]['aqi']],
[data[314]['day'], data[314]['month'], data[314]['aqi']],
[data[315]['day'], data[315]['month'], data[315]['aqi']],
[data[316]['day'], data[316]['month'], data[316]['aqi']],
[data[317]['day'], data[317]['month'], data[317]['aqi']],
[data[318]['day'], data[318]['month'], data[318]['aqi']],
[data[319]['day'], data[319]['month'], data[319]['aqi']],
[data[320]['day'], data[320]['month'], data[320]['aqi']],
[data[321]['day'], data[321]['month'], data[321]['aqi']],
[data[322]['day'], data[322]['month'], data[322]['aqi']],
[data[323]['day'], data[323]['month'], data[323]['aqi']],
[data[324]['day'], data[324]['month'], data[324]['aqi']],
[data[325]['day'], data[325]['month'], data[325]['aqi']],
[data[326]['day'], data[326]['month'], data[326]['aqi']],
[data[327]['day'], data[327]['month'], data[327]['aqi']],
[data[328]['day'], data[328]['month'], data[328]['aqi']],
[data[329]['day'], data[329]['month'], data[329]['aqi']],
[data[330]['day'], data[330]['month'], data[330]['aqi']],
[data[331]['day'], data[331]['month'], data[331]['aqi']],
[data[332]['day'], data[332]['month'], data[332]['aqi']],
[data[333]['day'], data[333]['month'], data[333]['aqi']],
[data[334]['day'], data[334]['month'], data[334]['aqi']],
[data[335]['day'], data[335]['month'], data[335]['aqi']],
[data[336]['day'], data[336]['month'], data[336]['aqi']],
[data[337]['day'], data[337]['month'], data[337]['aqi']],
[data[338]['day'], data[338]['month'], data[338]['aqi']],
[data[339]['day'], data[339]['month'], data[339]['aqi']],
[data[340]['day'], data[340]['month'], data[340]['aqi']],
[data[341]['day'], data[341]['month'], data[341]['aqi']],
[data[342]['day'], data[342]['month'], data[342]['aqi']],
[data[343]['day'], data[343]['month'], data[343]['aqi']],
[data[344]['day'], data[344]['month'], data[344]['aqi']],
[data[345]['day'], data[345]['month'], data[345]['aqi']],
[data[346]['day'], data[346]['month'], data[346]['aqi']],
[data[347]['day'], data[347]['month'], data[347]['aqi']],
[data[348]['day'], data[348]['month'], data[348]['aqi']],
[data[349]['day'], data[349]['month'], data[349]['aqi']],
[data[350]['day'], data[350]['month'], data[350]['aqi']],
[data[351]['day'], data[351]['month'], data[351]['aqi']],
[data[352]['day'], data[352]['month'], data[352]['aqi']],
[data[353]['day'], data[353]['month'], data[353]['aqi']],
[data[354]['day'], data[354]['month'], data[354]['aqi']],
[data[355]['day'], data[355]['month'], data[355]['aqi']],
[data[356]['day'], data[356]['month'], data[356]['aqi']],
[data[357]['day'], data[357]['month'], data[357]['aqi']],
[data[358]['day'], data[358]['month'], data[358]['aqi']],
[data[359]['day'], data[359]['month'], data[359]['aqi']],
[data[360]['day'], data[360]['month'], data[360]['aqi']],
[data[361]['day'], data[361]['month'], data[361]['aqi']],
[data[362]['day'], data[362]['month'], data[362]['aqi']],
[data[363]['day'], data[363]['month'], data[363]['aqi']],
// [data[364]['day'], data[364]['month'], data[364]['aqi']],




                    ],
                },
            ],
        };
// AQI 等级
const AQI_LEVELS = [
    {
        icon: 'k1',
        label: '优',
        otherName: '一级',
        value: 1,
        min: 0,
        max: 50,
        proposal: '空气质量令人满意，基本无空气污染',
        influence: '各类人群可正常活动',
        color: '#8DB25D',
        lightColor: '#D2F5A5',
    },
    {
        icon: 'k2',
        label: '良',
        otherName: '二级',
        value: 2,
        min: 51,
        max: 100,
        proposal: '空气质量可接受，但某些污染物可能对极少数异常敏感人群健康有较弱影响',
        influence: '极少数异常敏感人群应减少户外活动',
        color: '#DBCE66',
        lightColor: '#EBEBD8',
    },
    {
        icon: 'k3',
        label: '轻度',
        otherName: '三级',
        value: 3,
        min: 101,
        max: 150,
        proposal: '易感人群症状有轻度加剧，健康人群出现刺激症状',
        influence: '儿童、老年人及心脏病、呼吸系统疾病患者应减少长时间、高强度的户外锻炼',
        color: '#F49028',
        lightColor: '#F2E1C7',
    },
    {
        icon: 'k4',
        label: '中度',
        otherName: '四级',
        value: 4,
        min: 151,
        max: 200,
        proposal: '进一步加剧易感人群症状，可能对健康人群心脏、呼吸系统有影响',
        influence: '儿童、老年人及心脏病、呼吸系统疾病患者避免长时间、高强度的户外锻炼，一般人群适量减少户外运动',
        color: '#F35654',
        lightColor: '#F3D3D3',
    },
    {
        icon: 'k5',
        label: '重度',
        otherName: '五级',
        value: 5,
        min: 201,
        max: 300,
        proposal: '心脏病和肺病患者症状显著加剧，运动耐受力降低，健康人群普遍出现症状',
        influence: '儿童、老年人及心脏病、肺病患者应停留在室内，停止户外运动，一般人群减少户外运动',
        color: '#B255C5',
        lightColor: '#E5D2ED',
    },
    {
        icon: 'k6',
        label: '严重',
        otherName: '六级',
        value: 6,
        min: 301,
        max: '+',
        proposal: '健康人群运动耐受力降低，有明显强烈症状，提前出现某些疾病',
        influence: '儿童、老年人和病人应停留在室内，避免体力消耗，一般人群避免户外活动',
        color: '#F53362',
        lightColor: '#F3CBD7',
    },
];

/**
 * @description 获取AQI等级
 * @params {number} value
 */
const getLevel = (value) => {
    let index = 0;
    if (!value || value <= 50) index = 0;
    if (value > 50 && value <= 100) index = 1;
    if (value > 100 && value <= 150) index = 2;
    if (value > 150 && value <= 200) index = 3;
    if (value > 200 && value <= 300) index = 4;
    if (value > 300) index = 5;
    return { index, ...AQI_LEVELS[index] };
};

// 获取悬浮提示元素
const getTooltipRow = (params, isHideEmpty = false) => {
    if (isHideEmpty && !params.value) return '';
    return `
  <div style="display: flex; justify-content: space-between; min-width: 80px; padding-top: 3px;">
    <span style="${params.marker ? '' : 'padding-left: 18px'}">${params.marker || ''} ${params.seriesName}</span>
    <span style="padding-left: 10px; font-weight: bold;">${params.value || '-'}</span>
  </div>`;
};

const visualMapPieces = AQI_LEVELS.map(({ min, max, color }) => ({ min, max, color }));

var chartDom = document.getElementById('aqi_fenbu');
var myChart = echarts.init(chartDom);
var option;
option = {
    title: {
        text: '最近12个月空气质量分布',
        left: 'center',
        textStyle: {
            fontWeight: 'bold',
            fontFamily: 'Microsoft YaHei',
            fontSize: 18,
        },
    },
    tooltip: {
        position: 'top',
        formatter: (params) => {
            const dateStr = `${dataOrigin.yAxisData[params.data[1]]}-${params.name}`;
            const value = {
                marker: params.marker,
                seriesName: getLevel(params.data[2]).label,
                value: params.data[2] || '-',
            };
            return `${dateStr}<br />${getTooltipRow(value)}`;
        },
    },
    grid: {
        top: 40,
        left: 65,
        right: 15,
        bottom: 65,
    },
    visualMap: {
        show: false,
        dimension: 2,
        pieces: visualMapPieces,
        orient: 'vertical',  // 垂直显示
        left: 'left',        // 放置于左侧
        top: 'bottom',      // 顶部对齐容器底部
    },
    legend: {
        show: true,
        icon: 'circle',
        bottom: 10,
    },
    xAxis: {
        type: 'category',
        data: dataOrigin.xAxisData,
        axisLine: {
            show: false,
        },
        axisTick: {
            show: false,
        },
        splitArea: {
            show: true,
        },
    },
    yAxis: {
        type: 'category',
        data: dataOrigin.yAxisData,
        axisLine: {
            show: false,
        },
        axisTick: {
            show: false,
        },
        splitArea: {
            show: true,
        },
    },
    series: dataOrigin.seriesDatas.map(({ name, data, color }) => ({
        name,
        data,
        type: 'heatmap',
        label: {
            show: true,
        },
        itemStyle: {
            color,
            borderColor: '#fff',
            borderWitdh: 5,
            borderCap: 'round',
        },
    })),
};
myChart.setOption(option);})
.catch(error => console.error('Error:', error))}
fetch_city_year('重庆',2021)

document.getElementById('submitBtn').addEventListener('click',function (){
    event.preventDefault();
  let year = document.getElementById('yearSelect').value;
  let city=document.getElementById('citySearch').value;
  if (!city) {
        city = '重庆'; // 设置默认日期值
    }
  fetch_city_year(city,year)
})
